# 2026-01-21 Daily Log

## Projects
Started building [[nacre]] Phase 1 today. Scaffolded the monorepo with npm workspaces — `@nacre/core`, `@nacre/parser`, `@nacre/cli`. All types defined in core: MemoryNode, MemoryEdge, NacreGraph, GraphConfig.

**Marcus** reviewed the type definitions and suggested adding an `aliases` field to MemoryNode for entity resolution. Smart addition — "Marcus" and "Marcus S" and "marcus" should all resolve to the same node.

Also touched [[clawdbot]] to update the heartbeat hook interface. **Lobstar** needs a clean integration point for nacre consolidation.

## Implementation
Built the graph CRUD module first — createGraph, addNode, addEdge, reinforceNode, reinforceEdge. Node IDs are deterministic SHA-256 hashes of the canonical label. Edge IDs are composite keys: `${source}--${target}--${type}`.

The **entity resolution** chain: normalize → check aliases → exact match → fuzzy match (Levenshtein ≤ 2) → create new. This led to implementing a pure TypeScript Levenshtein distance function — no external deps for the core package. #architecture

## Tools
Using `tsup` for building each package. Fast, zero-config, and handles ESM + DTS generation cleanly. **TypeScript** strict mode catches real bugs — had a missing undefined check in the graph lookup that would have been a runtime error.

## Lessons
**Deterministic IDs from content** prevent duplicate nodes across consolidation runs. If the same entity is extracted twice, it maps to the same ID. Simple but powerful.
